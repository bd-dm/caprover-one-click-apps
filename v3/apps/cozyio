{"captainVersion":2,"dockerCompose":{"services":{"$$cap_appname-db":{"image":"nikdi/cozy-db","environment":{"DB_USER":"$$cap_appname-db-user","DB_PASS":"$$cap_appname-db-pass"},"ports":["5984:5984"],"volumes":["$$cap_appname-db-data:/opt/couchdb/data"],"networks":["app"],"notExposeAsWebApp":"true"},"$$cap_appname-stack":{"image":"nikdi/cozy-server","environment":{"DB_HOST":"$$cap_appname-db","DB_USER":"$$cap_appname-db-user","DB_PASS":"$$cap_appname-db-pass","DOMAIN":"$$cap_appname-domain","LOCALE":"$$cap_appname-locale","TIMEZONE":"$$cap_appname-timezone","COZY_PORT":"$$cap_appname-cozy-port","COZY_ADMIN_PORT":"$$cap_appname-cozy-admin-port","COZY_ADMIN_EMAIL":"$$cap_appname-admin-email","COZY_ADMIN_PASSWORD":"$$cap_appname-admin-pass","APPS":"$$cap_appname-apps"},"volumes":["$$cap_appname-cozy-data:/etc/cozy"],"ports":["3100:3100","3200:3200"],"networks":["app"],"containerHttpPort":"13000"}}},"variables":[{"id":"$$cap_firezone_version","label":"Firezone Version Tag","description":"Check out their Docker page for the valid tags https://hub.docker.com/r/firezone/firezone/tags","defaultValue":"0.7.35","validRegex":"/^([^\\s^\\/])+$/"},{"id":"$$cap_postgres_version","label":"Postgres Version Tag","description":"Check out their Docker page for the valid tags https://hub.docker.com/_/postgres/tags","defaultValue":15.4,"validRegex":"/^([^\\s^\\/])+$/"},{"id":"$$cap_default_email","label":"Default E-Mail"},{"id":"$$cap_default_password","label":"Default password","description":"Minimum 12 symbols"},{"id":"$$cap_reset_admin_on_boot","label":"Reset admin on boot","description":"true/false"},{"id":"$$cap_guardian_key","label":"Guardian key","description":"Use `openssl rand -base64 64` and then convert this string to base64. More info https://www.firezone.dev/docs/reference/env-vars#secrets-and-encryption"},{"id":"$$cap_encryption_key","label":"Encryption key","description":"Use `openssl rand -base64 32`. More info https://www.firezone.dev/docs/reference/env-vars#secrets-and-encryption"},{"id":"$$cap_secret_key","label":"Secret key","description":"Use `openssl rand -base64 64` and then convert this string to base64. More info https://www.firezone.dev/docs/reference/env-vars#secrets-and-encryption"},{"id":"$$cap_live_view_salt","label":"Live view salt","description":"Use `openssl rand -base64 64` and then convert this string to base64. More info https://www.firezone.dev/docs/reference/env-vars#secrets-and-encryption"},{"id":"$$cap_cookie_signing_salt","label":"Cookie signing salt","description":"Use `openssl rand -base64 64` and then convert this string to base64. More info https://www.firezone.dev/docs/reference/env-vars#secrets-and-encryption"},{"id":"$$cap_cookie_encryption_salt","label":"Cookie encryption salt","description":"Use `openssl rand -base64 64` and then convert this string to base64. More info https://www.firezone.dev/docs/reference/env-vars#secrets-and-encryption"}],"instructions":{"start":"To generate secret keys, use `openssl rand -base64 64`","end":"Firezone is deployed and available from the url http://$$cap_appname.$$cap_root_domain.\nAdd to Service Update Override: \n```json\n{\n  \"TaskTemplate\": {\n    \"ContainerSpec\": {\n      \"SysCtls\": {\n        \"net.ipv4.ip_forward\": \"1\",\n        \"net.ipv6.conf.all.disable_ipv6\": \"0\",\n        \"net.ipv6.conf.all.forwarding\": \"1\"\n      }\n    }\n  }\n}\n```\nAlso:\n  - Enable HTTPS\n  - Enable force to HTTPS\n  - Enable WebSocket support\nThen run:\n```bash\ndocker service scale srv-captain--$$cap_appname=0 && docker service update --cap-add NET_ADMIN --cap-add SYS_MODULE srv-captain--$$cap_appname && docker service scale srv-captain--$$cap_appname=1\n```\n"},"displayName":"Firezone","description":"Firezone","documentation":"https://www.firezone.dev/docs"}
